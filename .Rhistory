risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
#title = 'THR 50_1 and METABRIC OS by PAM50 subtypes: Q1 vs Q4'
)
dev.off()
ggsurvplot(Fit_sig_metabric_os_THR50_Q1vsQ4_X3,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "X3.Gene.classifier.subtype",
legend.title	= 'Quartiles',
pval.size = 15,
#break.x.by = 20,
palette = 'jco',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(17, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
legend.labs = c('Q1', 'Q4'),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
#title = 'THR 50_1 and METABRIC OS by PAM50 subtypes: Q1 vs Q4'
)
tiff("./figures/logreg/logistic_regression_oct11/metabric/THR50_1/OS/Q1_vs_Q4/THR50_1_metabric_os_X3_Q1vsQ4.tiff", width = 3200, height = 2200, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR50_Q1vsQ4_X3,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "X3.Gene.classifier.subtype",
legend.title	= 'Quartiles',
pval.size = 15,
#break.x.by = 20,
palette = 'jco',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(17, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
legend.labs = c('Q1', 'Q4'),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
#title = 'THR 50_1 and METABRIC OS by PAM50 subtypes: Q1 vs Q4'
)
dev.off()
gc()
# Clean the working directory
rm(list = ls())
# Load necessary packages
require(Biobase)
require(limma)
require(pROC)
require(caret)
require(RColorBrewer)
require(ggplot2)
require(reshape)
require(plotROC)
library(mltools)
library(xtable)
library(dplyr)
library(precrec)
library(patchwork)
library(survminer)
library(survival)
library(tidyverse)
library(pheatmap)
#################
THR_signature <- readxl::read_xlsx("./data/THR_Signatures_Jan25_2023.xlsx")
# get the THR50 signature
THR_70 <- THR_signature$`THR-70`[!is.na(THR_signature$`THR-70`)]
THR_70 <- gsub('-', '', THR_70)
################
# Load the  expression and pheno data
load('./objs/forKTSP.rda')
### combine in 1 dataset: Training
Data_metabric <- as.data.frame(cbind(t(Expr_metabric), group_metabric))
Data_metabric$group_metabric <- as.factor(Data_metabric$group_metabric)
levels(Data_metabric$group_metabric) <- c('0', '1')
colnames(Data_metabric)[colnames(Data_metabric) %in% c('group_metabric')] <- c('os')
##########
### tcga
Data_tcga <- as.data.frame(cbind(t(Expr_tcga), group_tcga))
Data_tcga$group_tcga <- as.factor(Data_tcga$group_tcga)
levels(Data_tcga$group_tcga) <- c('0', '1')
colnames(Data_tcga)[colnames(Data_tcga) %in% c('group_tcga')] <- c('os')
###########################################################################
### TRAINING using logistic regression
###########################################################################
rownames(Expr_metabric)[grep('^COT', rownames(Expr_metabric))]
rownames(Expr_tcga)[grep('^ZNF652', rownames(Expr_tcga))]
# modify the gene names
rownames(Expr_metabric)[rownames(Expr_metabric) == 'ChGn'] <- 'CSGALNACT1'
# filter the THR signatures to include only the genes present in the expr matrices
THR_70_fil <- THR_70[THR_70 %in% rownames(Expr_metabric) & THR_70 %in% rownames(Expr_tcga)]
setdiff(THR_70, THR_70_fil)
# re-combine the data
Data_metabric <- as.data.frame(cbind(t(Expr_metabric), group_metabric))
Data_metabric$group_metabric <- as.factor(Data_metabric$group_metabric)
levels(Data_metabric$group_metabric) <- c('0', '1')
colnames(Data_metabric)[colnames(Data_metabric) %in% c('group_metabric')] <- c('os')
#############################################################################################################
##############################################################################################################
# the model
THR70_model <- glm(as.formula((paste("os ~", paste(THR_70_fil, collapse = "+")))), data = Data_metabric, family = "binomial")
summary(THR70_model)
###########################################################################
############################################################################
### predict in the training dataset
# Make predictions
Train_prob_THR70 <- THR70_model %>% predict(Data_metabric , type = "response")
### Threshold
thr_THR70 <- coords(roc(group_metabric, Train_prob_THR70, levels = c("0", "1"), direction = "<"), "best")["threshold"]
thr_THR70
### ROC Curve
ROCTrain_THR70 <- roc(group_metabric, Train_prob_THR70, plot = F, print.thres=thr_THR70$threshold, print.auc=TRUE, print.auc.col="black", ci = T, levels = c("0", "1"), direction = "<", col="blue", lwd=2, grid=TRUE)
ROCTrain_THR70
### Get predictions based on best threshold from ROC curve
Train_predClasses_THR70 <- ifelse(Train_prob_THR70 >= thr_THR70$threshold, "1", "0")
table(Train_predClasses_THR70)
Train_predClasses_THR70 <- factor(Train_predClasses_THR70, levels = c('0', '1'))
### Resubstitution performance in the TRAINING set
ConfusionTrain_THR70 <- confusionMatrix(Train_predClasses_THR70, group_metabric, positive = "1", mode = "everything")
ConfusionTrain_THR70
## MCC
MCC_Train_THR70 <- mltools::mcc(pred = Train_predClasses_THR70, actuals = group_metabric)
MCC_Train_THR70
#########################################################################
#########################################################################
### Testing
tcga_prob_THR70 <-  THR70_model %>% predict(Data_tcga , type = "response")
### ROC
ROC_tcga_THR70 <- roc(group_tcga, tcga_prob_THR70, plot = F, print.thres=thr_THR70$threshold, print.auc=TRUE, print.auc.col="black", ci = T, levels = c("0", "1"), direction = "<", col="blue", lwd=2, grid=TRUE)
ROC_tcga_THR70
############################
### Get predictions based on best threshold from ROC curve
tcga_predClasses_THR70 <- ifelse(tcga_prob_THR70 >= thr_THR70$threshold, "1", "0")
table(tcga_predClasses_THR70)
tcga_predClasses_THR70 <- factor(tcga_predClasses_THR70, levels = c('0', '1'))
##################################
### CI  in testing 1
Confusion_tcga_THR70 <- confusionMatrix(tcga_predClasses_THR70, group_tcga, positive = "1", mode = "everything")
Confusion_tcga_THR70
################
## MCC
MCC_tcga_THR70 <- mltools::mcc(pred = tcga_predClasses_THR70, actuals = group_tcga)
MCC_tcga_THR70
##########################
## Keep only the relevant information (Metastasis Event and Time)
Phenotype_metabric <- cbind(Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.", "Relapse.Free.Status", "Relapse.Free.Status..Months.", "Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC", "X3.Gene.classifier.subtype")],
Train_prob_THR70, Train_predClasses_THR70)
Phenotype_tcga <- cbind(Pheno_tcga[, c("Overall.Survival.Status", "Overall.Survival..Months.", "Progression.Free.Status", "Progress.Free.Survival..Months.")],
tcga_prob_THR70, tcga_predClasses_THR70)
#Expr_metabric <- Expr_metabric[ClassifierGenes, ]
#Expr_tcga <- Expr_tcga[ClassifierGenes, ]
# create a merged pdata and Z-scores object
CoxData_metabric <- data.frame(Phenotype_metabric)
CoxData_tcga <- data.frame(Phenotype_tcga)
# divide the probabilities into quartiles
CoxData_metabric <- CoxData_metabric %>%
mutate(metabric_prob_THR70_quartiles = ntile(Train_prob_THR70, 4),
metabric_prob_THR70_quintiles = ntile(Train_prob_THR50, 5))
# divide the probabilities into quartiles
CoxData_metabric <- CoxData_metabric %>%
mutate(metabric_prob_THR70_quartiles = ntile(Train_prob_THR70, 4),
metabric_prob_THR70_quintiles = ntile(Train_prob_THR70, 5))
CoxData_tcga <- CoxData_tcga %>%
mutate(tcga_prob_THR70_quartiles = ntile(tcga_prob_THR70, 4),
tcga_prob_THR70_quintiles = ntile(tcga_prob_THR70, 5))
# OS
## metabric all genes
Fit_sig_metabric_os_THR70 <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ Train_predClasses_THR70, data = CoxData_metabric)
## by quartiles
Fit_sig_metabric_os_THR70_quartiles <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quartiles, data = CoxData_metabric)
## by quintiles
Fit_sig_metabric_os_THR70_quintiles <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quintiles, data = CoxData_metabric)
# RFS
## metabric all genes
Fit_sig_metabric_RFS_THR70 <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ Train_predClasses_THR70, data = CoxData_metabric)
## by quartiles
Fit_sig_metabric_RFS_THR70_quartiles <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quartiles, data = CoxData_metabric)
## by quintiles
Fit_sig_metabric_RFS_THR70_quintiles <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quintiles, data = CoxData_metabric)
# keep only the major pam50 subtypes
CoxData_metabric_PAM <- CoxData_metabric %>%
filter(Pam50...Claudin.low.subtype %in% c('Basal', 'claudin-low', 'Her2', 'LumA', 'LumB'))
# keep only quartiles 1 and 4 (has to be in each of THR25, THR70, and THR50_2)
CoxData_metabric_PAM_Q1vsQ4_THR70 <- CoxData_metabric_PAM %>%
filter(metabric_prob_THR70_quartiles %in% c('1', '4'))
CoxData_metabric_PAM_Q1vsQ5_THR70 <- CoxData_metabric_PAM %>%
filter(metabric_prob_THR70_quintiles %in% c('1', '5'))
# os: all
Fit_sig_metabric_os_THR70_PAM <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ Train_predClasses_THR70 + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM)
# os: quartiles: all
Fit_sig_metabric_os_THR70_quartiles_PAM <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quartiles + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM)
# os: quartiles: Q1 vs Q4
Fit_sig_metabric_os_THR70_Q1vsQ4_PAM <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quartiles + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM_Q1vsQ4_THR70)
# os: quintiles: all
Fit_sig_metabric_os_THR70_quintiles_PAM <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quintiles + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM)
# os: quintiles: Q1 vs Q5
Fit_sig_metabric_os_THR70_Q1vsQ5_PAM <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quintiles + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM_Q1vsQ5_THR70)
##########
# rfs: all
Fit_sig_metabric_rfs_THR70_PAM <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ Train_predClasses_THR70 + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM)
# os: quartiles: all
Fit_sig_metabric_rfs_THR70_quartiles_PAM <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quartiles + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM)
# rfs: quintiles: all
Fit_sig_metabric_rfs_THR70_quintiles_PAM <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quintiles + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM)
# rfs: quintiles: Q1 vs Q5
Fit_sig_metabric_rfs_THR70_Q1vsQ5_PAM <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quintiles + Pam50...Claudin.low.subtype, data = CoxData_metabric_PAM_Q1vsQ5_THR70)
# Note: we can use this for both ER and X3
CoxData_metabric_Q1vsQ4_THR70 <- CoxData_metabric %>%
filter(metabric_prob_THR70_quartiles %in% c('1', '4'))
CoxData_metabric_Q1vsQ5_THR70 <- CoxData_metabric %>%
filter(metabric_prob_THR70_quintiles %in% c('1', '5'))
# os: all
Fit_sig_metabric_os_THR70_ER <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ Train_predClasses_THR70 + ER.status.measured.by.IHC, data = CoxData_metabric)
# os: quartiles: all
Fit_sig_metabric_os_THR70_quartiles_ER <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quartiles + ER.status.measured.by.IHC, data = CoxData_metabric)
# os: quartiles: Q1 vs Q4
Fit_sig_metabric_os_THR70_Q1vsQ4_ER <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quartiles + ER.status.measured.by.IHC, data = CoxData_metabric_Q1vsQ4_THR70)
# os: quintiles: all
Fit_sig_metabric_os_THR70_quintiles_ER <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quintiles + ER.status.measured.by.IHC, data = CoxData_metabric)
# os: quintiles: Q1 vs Q5
Fit_sig_metabric_os_THR70_Q1vsQ5_ER <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quintiles + ER.status.measured.by.IHC, data = CoxData_metabric_Q1vsQ5_THR70)
##############
# rfs: all
Fit_sig_metabric_rfs_THR70_ER <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ Train_predClasses_THR70 + ER.status.measured.by.IHC, data = CoxData_metabric)
# rfs: quartiles: all
Fit_sig_metabric_rfs_THR70_quartiles_ER <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quartiles + ER.status.measured.by.IHC, data = CoxData_metabric)
# rfs: quartiles: Q1 vs Q4
Fit_sig_metabric_rfs_THR70_Q1vsQ4_ER <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quartiles + ER.status.measured.by.IHC, data = CoxData_metabric_Q1vsQ4_THR70)
# rfs: quintiles: all
Fit_sig_metabric_rfs_THR70_quintiles_ER <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quintiles + ER.status.measured.by.IHC, data = CoxData_metabric)
# rfs: quintiles: Q1 vs Q5
Fit_sig_metabric_rfs_THR70_Q1vsQ5_ER <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quintiles + ER.status.measured.by.IHC, data = CoxData_metabric_Q1vsQ5_THR70)
# os: all
Fit_sig_metabric_os_THR70_X3 <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ Train_predClasses_THR70 + X3.Gene.classifier.subtype, data = CoxData_metabric)
# os: quartiles: all
Fit_sig_metabric_os_THR70_quartiles_X3 <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quartiles + X3.Gene.classifier.subtype, data = CoxData_metabric)
# os: quartiles: Q1 vs Q4
Fit_sig_metabric_os_THR70_Q1vsQ4_X3 <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quartiles + X3.Gene.classifier.subtype, data = CoxData_metabric_Q1vsQ4_THR70)
# os: quintiles: all
Fit_sig_metabric_os_THR70_quintiles_X3 <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quintiles + X3.Gene.classifier.subtype, data = CoxData_metabric)
# os: quintiles: Q1 vs Q5
Fit_sig_metabric_os_THR70_Q1vsQ5_X3 <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ metabric_prob_THR70_quintiles + X3.Gene.classifier.subtype, data = CoxData_metabric_Q1vsQ5_THR70)
###########
# rfs: all
Fit_sig_metabric_rfs_THR70_X3 <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ Train_predClasses_THR70 + X3.Gene.classifier.subtype, data = CoxData_metabric)
# rfs: quartiles: all
Fit_sig_metabric_rfs_THR70_quartiles_X3 <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quartiles + X3.Gene.classifier.subtype, data = CoxData_metabric)
# rfs: quartiles: Q1 vs Q4
Fit_sig_metabric_rfs_THR70_Q1vsQ4_X3 <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quartiles + X3.Gene.classifier.subtype, data = CoxData_metabric_Q1vsQ4_THR70)
# rfs: quintiles: all
Fit_sig_metabric_rfs_THR70_quintiles_X3 <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quintiles + X3.Gene.classifier.subtype, data = CoxData_metabric)
# rfs: quintiles: Q1 vs Q5
Fit_sig_metabric_rfs_THR70_Q1vsQ5_X3 <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ metabric_prob_THR70_quintiles + X3.Gene.classifier.subtype, data = CoxData_metabric_Q1vsQ5_THR70)
# by quintiles
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_quintiles.tiff", width = 3000, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_quintiles,
risk.table = FALSE,
pval = FALSE,
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
ggtheme = theme_survminer(base_size = 30, font.x = c(30, 'bold.italic', 'black'), font.y = c(30, 'bold.italic', 'black'), font.tickslab = c(30, 'plain', 'black'), font.legend = c(30, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
#title = 'THR 50_1 (logistic regression) and METABRIC OS: quartiles'
)
dev.off()
# by quintiles
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_rfs_quintiles.tiff", width = 3000, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_RFS_THR70_quintiles,
risk.table = FALSE,
pval = FALSE,
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
ggtheme = theme_survminer(base_size = 30, font.x = c(30, 'bold.italic', 'black'), font.y = c(30, 'bold.italic', 'black'), font.tickslab = c(30, 'plain', 'black'), font.legend = c(30, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
#title = 'THR 50_1 (logistic regression) and METABRIC OS: quartiles'
)
dev.off()
## OS: quintiles: all
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_PAM50_quintiles.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_quintiles_PAM,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
#title = 'THR 50_1 (logistic regression) and METABRIC OS: quartiles'
)
dev.off()
# OS: quintiles: Q1 vs Q5
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_PAM50_Q1vsQ5.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_Q1vsQ5_PAM,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
legend.labs = c('Q1', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
#title = 'THR 50_1 (logistic regression) and METABRIC OS: quartiles'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_PAM50_Q1vsQ5.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_Q1vsQ5_PAM,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
legend.labs = c('Q1', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS: Q1 vs Q5'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_PAM50_quintiles.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_quintiles_PAM,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS: quintiles'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_rfs_quintiles.tiff", width = 3000, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_RFS_THR70_quintiles,
risk.table = FALSE,
pval = FALSE,
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
ggtheme = theme_survminer(base_size = 30, font.x = c(30, 'bold.italic', 'black'), font.y = c(30, 'bold.italic', 'black'), font.tickslab = c(30, 'plain', 'black'), font.legend = c(30, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS: quintiles'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_quintiles.tiff", width = 3000, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_quintiles,
risk.table = FALSE,
pval = FALSE,
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
ggtheme = theme_survminer(base_size = 30, font.x = c(30, 'bold.italic', 'black'), font.y = c(30, 'bold.italic', 'black'), font.tickslab = c(30, 'plain', 'black'), font.legend = c(30, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS: quintiles'
)
dev.off()
## OS: quintiles: all
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_PAM50_quintiles.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_quintiles_PAM,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS by PAM50 subtypes: quintiles'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_PAM50_Q1vsQ5.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_Q1vsQ5_PAM,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
legend.labs = c('Q1', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS by PAM50 subtypes: Q1 vs Q5'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_rfs_PAM50_quintiles.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_rfs_THR70_quintiles_PAM,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC RFS by PAM50 subtypes: quintiles'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_rfs_quintiles.tiff", width = 3000, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_RFS_THR70_quintiles,
risk.table = FALSE,
pval = FALSE,
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
ggtheme = theme_survminer(base_size = 30, font.x = c(30, 'bold.italic', 'black'), font.y = c(30, 'bold.italic', 'black'), font.tickslab = c(30, 'plain', 'black'), font.legend = c(30, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC RFS: quintiles'
)
dev.off()
#############################
# RFS: quintiles: Q1 vs Q5
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_rfs_PAM50_Q1vsQ5.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_rfs_THR70_Q1vsQ5_PAM,
risk.table = FALSE,
pval = T,
short.panel.labs = T,
facet.by = "Pam50...Claudin.low.subtype",
#legend.labs = c('Basal', 'Claudin-low', 'Her2+', 'Luminal A', 'Luminal B'),
legend.title	= 'Quintiles',
pval.size = 15,
#break.x.by = 20,
palette = 'jco',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(17, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
risk.table.y.text.col = FALSE,
legend.labs = c('Q1', 'Q5'),
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC RFS by PAM50 subtypes: Q1 vs Q5'
)
dev.off()
## OS: quintiles: all
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_X3_quintiles.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_quintiles_X3,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "X3.Gene.classifier.subtype",
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS by X3 subtypes: quintiles'
)
dev.off()
## OS: quintiles: Q1 vs Q5
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_os_X3_Q1vsQ5.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_os_THR70_Q1vsQ5_X3,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "X3.Gene.classifier.subtype",
legend.labs = c('Q1', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC OS by X3 subtypes: Q1 vs Q5'
)
dev.off()
####################################################
## RFS: quintiles: all
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_rfs_X3_quintiles.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_rfs_THR70_quintiles_X3,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "X3.Gene.classifier.subtype",
legend.labs = c('Q1', 'Q2', 'Q3', 'Q4', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC RFS by X3 subtypes: quintiles'
)
dev.off()
tiff("/Users/mohamedomar/Library/CloudStorage/Box-Box/TripleHormoneReceptor_THR_Signature/THR70_quintiles/THR70_metabric_rfs_X3_Q1vsQ5.tiff", width = 3200, height = 3000, res = 300)
ggsurvplot(Fit_sig_metabric_rfs_THR70_Q1vsQ5_X3,
risk.table = FALSE,
pval = TRUE,
short.panel.labs = T,
facet.by = "X3.Gene.classifier.subtype",
legend.labs = c('Q1', 'Q5'),
legend.title	= 'Quintiles',
ggtheme = theme_survminer(base_size = 18, font.x = c(18, 'bold.italic', 'black'), font.y = c(18, 'bold.italic', 'black'), font.tickslab = c(18, 'plain', 'black'), font.legend = c(18, 'bold', 'black')),
palette = 'jco',
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE,
title = 'THR-70 and METABRIC RFS by X3 subtypes: Q1 vs Q5'
)
dev.off()
MISI3542i_M3056_3 <- read.delim('/Users/mohamedomar/Documents/Research/Projects/Pca_TME/vectra/panel3/from_Nicolo/MISI3542i_M3056_3_Panel1_Scan1.qptiff_1386_job2589.object_results.csv')
MISI3542i_M3056_3 <- read.delim('/Users/mohamedomar/Documents/Research/Projects/Pca_TME/vectra/panel3/from_Nicolo/MISI3542i_M3056_3_Panel1_Scan1.qptiff_1386_job2589.object_results.csv', sep = ',')
View(MISI3542i_M3056_3)
?read.delim
MISI3542i_M3056_3 <- read.delim('/Users/mohamedomar/Documents/Research/Projects/Pca_TME/vectra/panel3/from_Nicolo/MISI3542i_M3056_3_Panel1_Scan1.qptiff_1386_job2589.object_results.csv', sep = ',', dec = ',')
?read.delim2
MISI3542i_M3056_3 <- read.delim('/Users/mohamedomar/Documents/Research/Projects/Pca_TME/vectra/panel3/from_Nicolo/MISI3542i_M3056_3_Panel1_Scan1.qptiff_1386_job2589.object_results.csv', sep = '\t', dec = ',')
MISI3542i_M3056_3 <- read.delim('/Users/mohamedomar/Documents/Research/Projects/Pca_TME/vectra/panel3/from_Nicolo/MISI3542i_M3056_3_Panel1_Scan1.qptiff_1386_job2589.object_results.csv', sep = ';', dec = ',')
MISI3542i_M3056_3 <- read.delim('/Users/mohamedomar/Documents/Research/Projects/Pca_TME/vectra/panel3/from_Nicolo/MISI3542i_M3056_3_Panel1_Scan1.qptiff_1386_job2589.object_results.csv', sep = ',', dec = ',')
gc()
