Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
#######################################################
# get the 5 groups
heat_metabric <- pheatmap(Expr_metabric_heatmap,
scale = "row",
#color = rev(heat.colors(20)),
color =ColPal,
annotation_colors = ann_colors,
cluster_cols = T,
cluster_rows = T,
#clustering_distance_cols = 'correlation',
#clustering_distance_rows = 'correlation',
clustering_method = 'ward.D',
show_colnames = F,
show_rownames = T,
annotation_col = AnnAll_metabric,
annotation_names_col = T,
#annotation_row = AnnAll_metabric,
annotation_names_row = T,
fontsize = 7,
#fontsize_col = 3,
fontsize_row = 10,
cex = 1,
cutree_cols = 5,
cutree_rows = 5,
breaks = seq(-1, 1, by = 0.1),
main = "")
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 5)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
ggsurvplot(Fit_metabric_RFS,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and RFS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 4)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 6)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
ggsurvplot(Fit_metabric_RFS,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and RFS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 7)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 8)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
#######################################################
# get the 5 groups
heat_metabric <- pheatmap(Expr_metabric_heatmap,
scale = "row",
#color = rev(heat.colors(20)),
color =ColPal,
annotation_colors = ann_colors,
cluster_cols = T,
cluster_rows = T,
#clustering_distance_cols = 'correlation',
#clustering_distance_rows = 'correlation',
clustering_method = 'ward.D2',
show_colnames = F,
show_rownames = T,
annotation_col = AnnAll_metabric,
annotation_names_col = T,
#annotation_row = AnnAll_metabric,
annotation_names_row = T,
fontsize = 7,
#fontsize_col = 3,
fontsize_row = 10,
cex = 1,
cutree_cols = 5,
cutree_rows = 5,
breaks = seq(-1, 1, by = 0.1),
main = "")
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 4)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 5)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 6)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
ggsurvplot(Fit_metabric_RFS,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and RFS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 7)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
ggsurvplot(Fit_metabric_RFS,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and RFS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 8)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
#######################################################
# get the 5 groups
heat_metabric <- pheatmap(Expr_metabric_heatmap,
scale = "column",
#color = rev(heat.colors(20)),
color =ColPal,
annotation_colors = ann_colors,
cluster_cols = T,
cluster_rows = T,
#clustering_distance_cols = 'correlation',
#clustering_distance_rows = 'correlation',
clustering_method = 'ward.D',
show_colnames = F,
show_rownames = T,
annotation_col = AnnAll_metabric,
annotation_names_col = T,
#annotation_row = AnnAll_metabric,
annotation_names_row = T,
fontsize = 7,
#fontsize_col = 3,
fontsize_row = 10,
cex = 1,
cutree_cols = 5,
cutree_rows = 5,
breaks = seq(-1, 1, by = 0.1),
main = "")
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 4)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 5)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 6)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
clusters_metabric <- as.data.frame(cbind(t(Expr_metabric_heatmap),
cluster = cutree(heat_metabric$tree_col,
k = 7)))
table(clusters_metabric$cluster)
# add the cluster info to the phenotype table
all(rownames(clusters_metabric) == rownames(Pheno_metabric))
Pheno_metabric$cluster <- clusters_metabric$cluster
#############################################################################################################
##############################################################################################################
## Keep only the relevant information (Metastasis Event and Time)
survival_metabric <- Pheno_metabric[, c("Overall.Survival.Status", "Overall.Survival..Months.",
"Relapse.Free.Status", "Relapse.Free.Status..Months.",
"Pam50...Claudin.low.subtype", "ER.status.measured.by.IHC",
"X3.Gene.classifier.subtype", "cluster")]
# OS
Fit_metabric_os <- survfit(Surv(Overall.Survival..Months., Overall.Survival.Status) ~ cluster, data = survival_metabric)
# RFS
Fit_metabric_RFS <- survfit(Surv(Relapse.Free.Status..Months., Relapse.Free.Status) ~ cluster, data = survival_metabric)
############################################################################
############################################################################
# plot OS
ggsurvplot(Fit_metabric_os,
risk.table = FALSE,
pval = TRUE,
#legend.labs = c('prediction: 0', 'prediction: 1'),
ggtheme = theme_minimal(),
risk.table.y.text.col = FALSE,
risk.table.y.text = FALSE, title = 'THR50 clusters and OS')
4*165
